CHAPTER THREE
The Universal Library

Imagine standing in a room crammed with books from floor to ceiling. The bookshelves barely leave space for the door you see on each of the four walls. You start leafing through the books and realize that they all have the same number of pages. Each page contains the same number of lines. And each line has the same number of characters. But—this is strange—the books are full of gibberish. Each line of each page of each book contains mostly arbitrary strings of letters—“hsjaksjs  .  .  . ,” “zvaldsoeg  .  .  . ,” and so on—occasionally separated by spaces and punctuation. Only rarely do you find a meaningful English word—“cat,” “teapot,” “bicycle”—islands in a vast sea of more gibberish.
After a while you tire of these books, which do not make sense. You step through one of the doors and find yourself in another room just like the first one. It is equally packed with bookshelves that crowd in on four doors. And its books make no more sense than those in the first room.
Another door leads you to yet another identical room, and from there you begin to wander through room after room after room, and realize that you are in an endless maze of rooms, identical except for the books that inhabit them. These books form a library that is as gigantic as it is bizarre. As you wander through this library, you encounter fellow travelers who help you grasp the enormity of this place.
The rooms form a universal library, home to all conceivable books.
That is, its books contain all possible strings of characters—twenty-six letters and a few punctuation marks. Most of the strings are the nonsense you already read. But occasionally a book will contain a meaningful word, sentence, or paragraph. More than that, somewhere in this library dwell books that contain no gibberish whatsoever. Because the library contains all possible books, it also contains each meaningful book ever written. All possible novels, short stories, poetry collections, biographies (of people real or imagined), philosophical treatises, religious books, books of science and mathematics, all conceivable books written not only in English but in all languages, books that reveal everything that is true, but also spin terrible lies, books that talk about other books, about the library itself and where it came from, books, some true, others false, about your life’s story, how it began and how it will end, and the book you are reading right now. All of them are contained in this library—a library enormous almost beyond imagining.
To get of an idea how large this library is, let us say that every book in it contains 500,000 characters. (That’s not very long—in the same ballpark as the book you are reading right now.) Excluding punctuation marks, there are 26 possibilities (A through Z) for each of these 500,000 characters. That is, there are 26 possibilities for the first character, 26 for the second, 26 for the third, and so forth. To estimate the number of books, we thus need to multiply 26 by itself 500,000 times. Mathematicians would write this number as 26 raised to the power of 500,000, or 26500000. This is a very large number, amounting to a 1 with more than 700,000 zeroes behind it, more zeroes than this book has letters. And far greater than the number of hydrogen atoms in the universe. It is a hyperastronomical number.
The deepest secrets of nature’s creativity reside in libraries just like this: all-encompassing and hyperastronomically large. Only instead of being written in human language, the texts in these libraries are written in the genetic alphabet of DNA and the molecular functions that DNA encodes.
Human books can capture entire universes—everything that human language can utter—but they have nothing on the chemical language of what may be life’s oldest library of creation, the one devoted to metabolism. Every one of the trillions of living things on earth can be describedby human prose or poetry. But creating any one of them requires the chemical language of metabolism, the chemical reactions that create the building blocks of life and thus ultimately all living matter. The library’s chemical language can express life itself—all of it.
FIGURE 4.A metabolic genotype
To date, we have discovered more than five thousand different chemical reactions that some organism, somewhere on our planet, uses to produce the building blocks of life I mentioned in chapter 2, the nucleotides that make up DNA and RNA, and the amino acids from which proteins are constructed. The reactions that occur in E. coli—more than a thousand—are among them, as are all known chemical reactions that take place in any bacterium, fungus, plant, or animal—including humans. When your body extracts energy from sugar or any other food, it uses such reactions. It also uses them when healing the few hundred skin cells covering a scraped knee, and when replenishing the millions of red blood cells that die every day.
No organism can catalyze all five-thousand-odd known reactions, but every organism can catalyze some,and the reactions it cancatalyze make up its metabolism. For multiple organisms we know these reactions, thanks to twentieth-century biochemistry and to the technological revolutions of the early twenty-first century. They gave us access to a mountain of metabolic information on more than two thousand different organisms, stored in giant online repositories, such as the Kyoto Encyclopedia of Genes and Genomes, or the BioCyc database, and accessible in split seconds from any computer with an Internet connection. 
Figure 4 shows how we can organize this information. The left side of the figure stands for a list of five thousand reactions—written as chemical equations. To avoid clutter I wrote out the molecules in only one of them—the sucrose-splitting reaction—but simplified all others to a single letter. Let’s consider one organism, such as E. colior a human, and mark a “1” next to a reaction if our organism can catalyze this reaction—it has a gene making an enzyme for it. Otherwise we’ll mark a “0.” The result is a long list of ones and zeroes like that in the figure, a compact way to specify a metabolism.
Bacteria such as E. colican make all twenty amino acids in proteins, whereas metabolic cripples like us humans can make only twelve of them. We lack the necessary enzymes and reactions for the remaining eight. The figure’s shorthand way of describing a metabolism is ideal for expressing differences like this: Because we lack some reactions, our list of reactions contains some zeroes where that of E. colicontains ones.
A list like this is also an extremely compact way to write an organism’s metabolic genotype—the part of the genome encoding its metabolism—because an organism’s list of reactions is ultimately encoded in its DNA. You can also think of the list as a text written in an alphabet with only two letters, and without spaces or punctuation marks, like this: “1001  .  .  . 0110  .  .  . 0010.” The first letter in such a text might correspond to the sucrose-splitting reaction, which is present (“1”) in this example, whereas the second reaction might be one of those needed to synthesize an essential amino acid—it is absent (“0”) in this example text but could be present (“1”) in another organism’s genotype—and so on.
It is a text in a library vast beyond imagination, the library of all possible metabolisms.
The number of texts in that library can be calculated with the same arithmetic that computed the size of the universal library of books. Because each reaction in the known universe of reactions can be either present or absent in a metabolism, there are two possibilities (present or absent) for the first reaction, two for the second reaction, and so on, for each reaction in the universe. To calculate the total number of texts, we multiply the number 2 by itself as many times as there are reactions in our universe. For a universe of 5,000 reactions, there are 25000possible metabolisms, 25000texts written in the alphabet of zero and one, each of them standing for a different metabolism. This number is greater than 101500, or a 1 with 1,500 trailing zeroes. While not quite as large as the number of texts in the universal library of human books, it is still much larger than the number of hydrogen atoms in the universe. The metabolic library is also hyperastronomical.
And just as the universal library contains all meaningful books, the library of metabolisms contains all “meaningful” metabolisms—those that allow an organism to survive—and many more, because not all metabolisms are meaningful, just as not all books are. Some metabolisms cannot procure energy, or they fail to manufacture important molecules. These are like books where some chapters, paragraphs, or sentences are coherent but the book as a whole does not make sense. And many other metabolic texts are gibberish. These are metabolisms with disjointed reaction sequences dead-ending on molecules useless to life, the equivalent of books containing only meaningless character strings
If you wandered through the universal library of books long enough, you would find books that surprise you. They contain novel thoughts, ideas, and inventions. The genotypic texts in the universal metabolic library are no different. They can encode metabolisms with never-before-seen chemical abilities, novel phenotypes that manufacture new molecules or use new fuels. In short, innovations.
Because metabolism is as old as life itself, evolving life has explored this library ever since it originated. A billion years ago, nature had already discovered unimaginably many metabolic phenotypes, enough of them that it might have stopped finding innovative metabolic texts long since. But far from resting on its early laurels, evolution is still discovering such texts, much faster than we can decipher them, in billions and trillions of organisms alive today. Some of these texts appeared less than a hundred years ago—a mere moment in evolutionary time.
Consider pentachlorophenol, a nasty molecule that humans first produced in the 1930s. It is used in antifouling paint to coat ships’ hulls, and also as an insecticide, fungicide, and disinfectant—in short, to kill life. Pentachlorophenol also damages our kidneys, blood, and nervous system, and it causes cancer. But despite its noxious nature, life has found ways not only to tolerate pentachlorophenol but to thrive on it. The aptly named bacterium Sphingobium chlorophenolicumcan extract both energy and carbon from it, using pentachlorophenol as its only food source. To do so, its genome encodes four enzyme-catalyzed reactions that convert pentachlorophenol into molecules that are as digestible as glucose—the equivalent of transforming a chemical weapon into a chocolate bar. 
The combination of these reactions is unique to S. chlorophenolicum,but the reactions themselves are not. Each of them occurs in hundreds if not thousands of other organisms. Two of them help recycle superfluous amino acids in some bacteria, whereas the other two disarm toxic molecules produced by some fungi and insects—molecules that happen to resemble pentachlorophenol. Like a garage mechanic building a sprinkler system out of an alarm clock, a bicycle pump, and some PVC pipe, evolution has created in S. chlorophenolicuma new arrangement of chemical reactions catalyzed by enzymes that individually exist in other organisms. In other words, metabolic innovation is combinatorial.
Innovations that allow organisms to feed on highly toxic, man-made molecules are not rare. The bacterium Burkholderia xenovorans happilyfeeds on the now outlawed polychlorinated biphenyls, which were widely used in making plastics and in the electrical industry. Other bacteria readily digest chlorobenzene, a toxic organic solvent used in chemical laboratories. And even more striking are the bacteria that feed on the very antibiotics designed to kill them. Some of these antibiotics are man-made, so bacteria did not encounter them until recently.
Just as nature can convert poisons into food, it also came up with ingenious ways of managing its waste. Ammonia (NH3), for example, isn’t just the gas in household cleaners with the sharp, unpleasant odor that makes your eyes burn, but a highly toxic waste product of animal metabolism. Because ammonia dissolves in water, fish can just excrete it into the water surrounding them and forget about it—the fish equivalent of peeing in the swimming pool. But when animals first conquered land more than three hundred million years ago, they did not have this luxury. They needed to prevent toxic ammonia gas from poisoning their blood.
The solution lay in a metabolic text that contains the instructions for converting ammonia into the less toxic molecule urea, which we secrete to this day in our urine. This metabolic innovation involves five common chemical reactions, each one independently useful to organisms long before the need to detoxify ammonia appeared. 
When exactly this innovation appeared is unknown, but clues are easy to find. Even though modern teleosts—bony fish—have no need to detoxify ammonia, theirancestors already harbored a chemical blueprint for making urea, still seen in cartilaginous fish like sharks and rays that swam through the oceans long before modern fish appeared. However, the title character of Jawsuses urea for a different purpose than the humans hunting it—for nitrogen storage, buoyancy, or as a counterweight to the salt in seawater. (You might think that the DNA of bony fish should contain some remnant of this innovation, if it had already originated in their distant ancestors. And that’s indeed the case: The text for the urea cycle still exists in bony fish, even though they rarely express its chemical meaning. They are a bit like adults who learned a language while infants and can still recognize some of its words.)9
Detoxifying your waste is good, but recycling it is even better, and nature excels at that too. The nitrogen waste of animals—ammonia or urea—fertilizes plants. The very oxygen we breathe is a waste product of photosynthesis. And every gram of feces is teeming with billions of bacteria feeding on the molecules in it: One man’s waste is a bacterium’s treasure. Each one of these bacteria harbors a metabolic text, ancient or recent, to break down molecules, extract energy and chemical elements, and build new life from them.
Innovative metabolic texts are just as ubiquitous in extreme environments—extremely hot, extremely cold, excessively dry, highly caustic, exceedingly radioactive, super-salty, and so on—as in temperate ones. Bacteria in particular can thrive in boiling water and in ice, in highly corrosive sulfuric acid and in crushing oceanic depths. To survive, they had to innovate, and many of their innovations—you guessed it—are metabolic.
Without these innovations, extreme environments would kill bacteria just as easily as they kill us. Too much salt, for example, kills cells, because it forces water out through osmosis and prevents enzymes from doing their job—they need water as a lubricant. To clog this drain, metabolism produces molecules with exotic names such as ectoine and glycine betaine that cannot leave a cell as easily as water does, and that can stand in for water molecules lost through osmosis. They keep proteins lubricated. To make these molecules, cells need only a few extra enzyme-catalyzed chemical reactions that start with common molecules like the amino acid aspartate. Add these reactions to a metabolism, and you have a leg up in the most hostile environment. Halophilic bacteria—the name comes from the Greek for “salt-loving”—can survive salt concentrations of 30 percent, ten times higher than the seawater that kills us when we drink it. They can even live around and inside salt crystals. 
Extreme environments are no picnic, but life can be even harder if you face predators and parasites, and especially if escaping them is not an option. Any ordinary plant would be an immovable feast for many organisms, from insects and worms tunneling through the soil to slugs and other herbivores aboveground. Because plants can’t so much as twitch in their own defense, they develop chemical weapons, molecules so toxic that animals avoid them. Plants are not alone in using chemical warfare, but they are especially adept at it, perhaps because they are, literally, rooted to one spot.
These defensive molecules are metabolic innovations, because they require new combinations of chemical reactions to synthesize them. One of them is the nicotine produced by tobacco plants that some of us blissfully inhale through cigarettes, even though it is so toxic that some farmers use it as an insecticide. But plants had the idea first, as a group of German scientists recently showed. When they artificially lowered the amount of nicotine that tobacco plants produce, insects developed a voracious appetite for the plants. They attacked the plants more often, ate more leaves, and grew faster. The plants, in turn, lost three times more leaves than normal plants to their attackers12
Nicotine is only the best known of more than three thousand similar alkaloids—a catchall term for organic molecules built around nitrogen atoms, including caffeine and morphine—that plants use in chemical defense. And although they are numerous, alkaloids are only one among several kinds of chemical warfare molecules. Others include the astringent tannins that make your mouth feel dry and shriveled when you eat unripe fruit. Tannins bind very tightly to plant proteins and prevent our gut from digesting these proteins, which discourages us from feeding on them in the first place. Cyanogenic glycosides are especially nasty chemical defense molecules that are produced in cassava or manioc, the important African and South American food plant14Unless you remove these glycosides by cooking or soaking, they release hydrogen cyanide, the active ingredient of the Zyklon B pesticide piped into the “showers” at Nazi extermination camps like Auschwitz-Birkenau. If you ever thought of nature as that idyllic place, the next best thing to the Garden of Eden, a tutorial on chemical warfare in plants will quickly dispel that myth.
Biochemical warfare molecules like these are metabolic innovations, add-ons to an existing metabolism manufactured by new sequences of chemical reactions that start from common biomass molecules and transform them into potent poisons. Each one requires specific passages of text in a metabolic genotype.
Some of nature’s ways to find new metabolic texts are familiar, because they dominate in large multicellular animals like us. They include the changes accompanying sexual reproduction, which shuffles chromosomes like decks of cards, so that each of our children starts with a new deal. Then there are the spontaneous mutations in a DNA’s letter sequence, arising through chance events such as when photons of ultraviolet radiation smash into the genome, or through highly reactive oxygen radicals that are by-products of chemical reactions and burst the chemical bonds of nearby DNA.
Neither way to explore the metabolic library is very effective. Since the shuffling of sexual reproduction occurs between highly similar genomes—two human genomes share 99.9 percent of their DNA letter sequence—it is not the most effective way to create new metabolisms. It is like trying to write a new play by changing thirty words in Hamlet. And while mutations can create new proteins, including new enzyme catalysts, they are rare, which means the process is rather slow.
And there is one more reason why metabolic innovation is not swift in large, multicellular animals. A new way of using energy or building organic structures can make its value known only at the speed that it spreads throughout a population, and animals that produce a new generation every few decades—or even every few months—can’t innovate any more rapidly than that.
All this doesn’t mean that animals like us are completely impoverished when it comes to metabolic innovations. Our bodies, for example, can disarm drugs—like the widely used aspirin, known to chemists as acetylsalicylic acid—through a metabolic process called glucuronidation that renders them less toxic and excretable in urine. Cats and some other carnivores like hyenas lack this enzyme. (Consult a vet before medicating your pet hyena with aspirin.) You may ask why our bodies have this enzyme, which evolution created long before the company Bayer first marketed aspirin in the 1890s. The clue lies in aspirin’s name itself, which comes from an old name for a plant called meadowsweet, Spiraea ulmaria. This and many other plants have been used since antiquity for pain relief. What is more, plants containing salicylic acid were part of our ancestors’ diets, such that our omnivoric bodies—unlike those of carnivores like hyenas—needed a way to detoxify it.
Within the multicellular world, humans are far from the pinnacle of metabolic creation, however, because many animals beat us in other aspects of metabolism. Humans cannot produce vitamin C, and must therefore drink it with a morning glass of orange juice, whereas dogs can make their own. And although we can extract calories from the seeds of grasses like wheat and maize, cows are better at digesting the cellulose in their stalks. To be fair, however—credit where it is due—that miracle of metabolism isn’t really a bovine innovation, but a microbial one: It is the bacteria in the four-stomached cows that convert gigantic cellulose molecules into easily digested glucose.
Which is a hint that the real geniuses of innovation are the smallest organisms on the planet: bacteria.
This isn’t just because bacteria produce new generations in minutes rather than years, and so can improve their genetic toolkits much faster than we. The innovation advantage of bacteria goes much deeper than that. To grasp how big it is, imagine a teenage boy trying to make his high school basketball team, even though he’s only a shade over five feet tall. Hard work and exercise can only take him so far. He just doesn’t have the right genes—not like his best friend, who can practically touch the rim on his tiptoes.
A bacterium wanting the bacterial equivalent of a forty-inch vertical leap isn’t limited by the genes bequeathed it by previous generations. If, in some science-fiction movie, perhaps, the two basketball-playing friends had the same innovation equipment as bacteria, the process would look something like this. Our two characters are dining in their favorite restaurant when a slender hollow tube begins to grow out of the taller boy’s body, blindly groping toward the shorter. As soon as it connects, this tube injects a random fragment of the taller guy’s DNA text into the other body, and if this DNA contains the right genes, the high school basketball team gets a new power forward
This is an example of horizontal gene transfer, a phenomenon tragically unavailable to disadvantaged humans but rampant in microbes. Sometimes when two bacteria are in proximity, one of them will extrude a slender stalklike hollow tube in the direction of the other. When the tube docks, it shrinks in length, draws the two cells closer, and through the tunnel thus created, one cell transfers DNA to its neighbor.
This transfer resembles sex as we know it, because a penislike tube transfers genetic material from one organism to another. But bacterial and human sex are quite different. Their sex, unlike ours, does not serve reproduction. And it doesn’t even shuffle a whole genome, but usually just transfers a few genes.
Bacteria can acquire new genes in other ways too. Some absorb DNA from other cells after they die, rupture, and spill their molecular innards. As boneheaded as a person who would rather eat books—surely a great source of fiber—than read them, they use some of this DNA as food. Occasionally, though, the eaten DNA becomes hitched to their genome and helps make new proteins. 
Gene transfer can also take advantage of viruses, those tiny lifeless particles whose DNA can enslave cells many times their size. While viruses reprogram a cell into a helpless factory that clones its viral masters, small pieces of the cell’s DNA can fuse with the viral genome. These pieces piggyback on newly minted viruses that leave the cell, and get injected along with the viral genome into the next hapless victim. In this scenario, one of our basketball-playing friends might simply have to sneeze on the other, whereupon his talent could be transferred to his teammate’s newly improved genome.
If all this horizontal gene transfer went on unchecked, the size of a genome would constantly increase over time and become grotesquely bloated. But excessively long DNA strings break more easily, and copying them wastes energy and materials—a mortal sin that nature won’t tolerate. Fortunately, such bloating does not occur, because gene transfer is balanced by gene deletions. These are the by-products of errors that happen when cells cut or splice DNA molecules as they repair and copy their DNA. Unlike DNA mutations that alter one letter at a time, deletions can strike out thousands of letters and many genes. As long as a deletion affects no essential genes, the cell can live with it. Such survivable deletions occur all the time. They ensure that only useful genes stay around in the long run, and they keep genomes lean.
In another difference from sex as we know it, gene transfer occurs not just between similar organisms but also between baker’s yeast and fruit flies, between microbes and plants, and especially among bacteria, which can be as different from one another as humans are from oak trees. This is why gene transfer is so powerful, and the most important reason why bacteria are masters of metabolic innovation. Very different organisms harbor very different metabolic texts, and gene transfer can edit one text with borrowed passages that are very different yet meaningful within another text, the microbial equivalent of a musical mash-up that combines a Baroque instrumental track with a pop vocal. Only some edits will improve a text, because the recipient cannot pick and choose which new genes it gets—they are a random subset of the donor’s genome. But because gene transfer is incredibly frequent, the odds for innovation aren’t bad: Even though many edits lack luster, the shelves of life’s universal library contain a virtually infinite number of masterpieces waiting to be found.
An example of nature’s editorial prowess is our friend E. coliand its multiple varieties, E. colistrains that were long thought to be like closely related ethnic groups. At the beginning of the twenty-first century, biologists first deciphered the genomes of many such strains, expecting them to be very similar. False. Two E. colistrains can differ in more than one million letters, or one-quarter of their DNA, such that one strain can harbor a thousand genes that the other strain lacks. Every million years—a blip of evolutionary time, 20 percent of the time since humans diverged from chimpanzees—an E. coligenome acquires some sixty new genes, all of them through horizontal gene transfer. And these are only the successful edits—many others have gone out of print and left no descendants.
FIGURE 5.Genotype distance
We already know the DNA sequences of more than a thousand bacterial species, and they testify that E. coliis not an exception, but the rule. Most bacterial genomes are just as packed with genes trafficked from other sources, many with an unknown origin, though this is scarcely surprising. Trying to discover the provenance of a particular gene is a bit like trying to trace the literary influences revealed in a single paragraph of a novel by reading a small and random selection of the Library of Congress. A thousand species—or even a hundred thousand—would still be a drop in the ocean of bacterial diversity with countless millions of bacterial species, most of them unknown, all of them potential gene donors.
Not all of this genomic change causes metabolic change, because only a third of a genome is devoted to metabolism—the proteins it encodes also have a lot of other business, helping a cell move around, transporting building materials, and so on. So what if gene transfer mostly shuffles the nonmetabolic parts of the genome? Then evolution’s journey through the metabolic library might not take it far, and most metabolisms would therefore be very similar.
Are they? A few years ago, I asked this question of hundreds of bacterial species with known genomic DNA sequences, in a study that relied on decades of research done before my time. This research had discovered thousands of genes that code for particular enzymes, and allowed us to draw maps that connect genes with enzymes, and enzymes with chemical reactions. In other words, we could translate a genome sequence into a metabolic genotype, and compare these genotypes among organisms. And that is what I did.
Figure 5 shows how easy it is to compare two metabolic texts, using the simple example of two short snippets corresponding to ten enzymes in two organisms. Four of the ten enzymes cannot be made by either organism (gray zeroes), six are encoded by the first organism—its genotype string has six ones—and five are encoded by the second organism. We take the number of enzymes (six) made by at least one of the two organisms, and the number of enzymes made by only one but not the other organism (one enzyme), and calculate the ratio (1/6) of these numbers. If this ratio were zero, then two organisms would encode exactly the same enzymes. If it were 1/2, then half of the enzymes that one organism can produce would also be produced by the other organism. If the ratio were equal to 1, then the first organism wouldn’t be able to produce a single enzyme that the second organism can produce—their metabolisms would be maximally different. Those ratios, ranging from 0 to 1, reflect the difference between the enzymatic portfolios of two organisms, but that’s a little unwieldy to write over and over again—better to replace it with the symbol Dfor differenceor distance28
Unspeakably tedious as comparing genotypes for hundreds of bacteria—each encoding more than a thousand reactions—would be on pencil and paper, my trusted computer can finish it in the blink of an eye. When I asked it to calculate Dfor hundreds of pairs of bacteria, I was surprised to see—although their highly diverse genomes should have warned me—that even closely related organisms had highly diverse metabolic texts. Thirteen different strains of E. colidiffered in more than 20 percent of their enzymes. An average pair of microbes differed in more than half of them. I had also suspected that bacteria living in the same environment—the soil, for example, or the ocean—might encounter similar nutrients and thus have similar metabolic texts. Wrong. Their metabolic texts were just as diverse, with a D just as different as that from bacteria living in different environments.
This exercise underscores the staggering scale at which nature experiments through gene shuffling. Everywhere on this planet, a relentless shuffling and mixing and recombining of genes takes place. Wherever microbial life occurs, in the depth of the oceans and on arid mountaintops, in scalding hot springs and on frigid glaciers, in fertile soils and desiccated deserts, inside and around our bodies, life is experimenting with every conceivable combination of new genes, rereading, editing, and rejuggling its metabolic texts without pause, yielding an enormous and still growing diversity of metabolisms.
Without readers, a book is a bundle of cellulose sheets with meaningless ink stains. Likewise, a text in the metabolic library needs to be read to reveal its meaning: the metabolic phenotype that determines which fuels an organism can use, and which molecules it can manufacture. We think of a phenotype as something we can see, and many metabolic phenotypes are plain as daylight. They include the melanins that protect our skin against radiation, that camouflage a lion’s fur, and that color the ink of an octopus. All of them are molecules synthesized by metabolism. And so are the various pigments that dye tree leaves, lobsters, flowers, and chameleons, whether for defense, courtship, or sometimes for no good reason at all. But metabolic phenotypes do not end at this visible surface. They extend to depths that are hidden from our eyes yet visible to chemical instruments—and to natural selection. Their most important role is to ensure viability itself, which boils down to the ability to synthesize sixty-odd molecules very different from those pretty pigments—they are the essential biomass molecules I mentioned in chapter 2. Viability, viewed as the phenotypic meaning of a genotypic text, is like the simple moral of a complex story, or like a brutally straightforward court judgment: If you can’t make all essential biomass molecules, your sentence is death, and it is carried out immediately. Organisms with a mutation that has compromised the ability to synthesize essential molecules don’t just fail to live long enough to reproduce. They don’t live at all
To grasp this phenotypic meaning—viability or death—we need to read an organism’s metabolic genotype. This is a tall order, not only because the meaning of a text is so much more complex than the text itself—to understand the moral, we have to understand the whole story—but also because our brains are not well practiced in reading chemical language. Fortunately, we can program the artificial intelligence of computers to assist us.
A genotype tells us which reactions a metabolism can catalyze, the molecules these reactions consume, and the molecules they produce. To decipher its meaning, we would first need to know which nutrients are available—without the right ingredients, you cannot bake a cake—and whether the metabolism can use them to build an essential biomass molecule such as tryptophan. This is easiest for the austere minimal environments where survivalists like E. colican thrive, because they contain so few nutrients, sometimes only a single sugar that provides all the carbon and energy the organism needs.
Starting from the available nutrients, we would then write a list of all the molecules the metabolism’s reactions producefrom the available nutrients, find the reactions in the genotype that consumethese product molecules, and list theirproducts, iterating in this way until we find one or more reactions whose products include tryptophan. If no such reaction exists, then the metabolism cannot produce tryptophan.
FIGURE 6.Metabolic phenotypes
We would then move on to another biomass molecule, perhaps another amino acid, or one of the four DNA building blocks, repeating the entire procedure for each of the building blocks to find out whether the metabolism can manufacture it. Only when allessential biomass molecules can be produced is it viable. 
All of this is done on computers, because computation—done right—is faster, cheaper, and can even be better than experimentation. But as the saying goes, the map is not the territory, and we biologists do not fully trust any computation until we can check it. So like a factory that spot-checks its output randomly, we expose organisms with known metabolic genotypes to known chemical environments, and wait, somewhat ghoulishly, for them to grow or die. This has been done, for example, to several hundred mutant E. colistrains, each of them engineered to lack one enzyme, and it shows that their computed viability is highly accurate—it is correct for more than 90 percent of strains. 
Most biologists who know about this computation think of it as ordinary and do not dwell on how remarkable it is. But more than just remarkable, the capacity to compute viability is profound and revolutionary, a legacy of a hundred years of research in biology and computer science. Darwin and generations of biologists after him could not even dream of it, yet it is crucial to understanding metabolic innovability—nature’s ability to create new metabolic phenotypes.
This computation works for any organism whose metabolism we know, and for any known chemical environment, whether Arctic soil, tropical rain forest, oceanic abyss, or a mountain meadow. It also applies to any aspect of a metabolic phenotype—to any molecule a metabolism couldmake. But among all these aspects, viability is the most fundamental, and new methods of making biomass and using chemical fuels are by far the most important innovations. They are also the most far-reaching, opening new territories to life and its metabolic engines.
The reason for the importance of fuel innovations is simple: The world changes all the time, and no matter how successful a metabolism is today, it will almost certainly become unsuccessful at some point in the future, like an economy that depends on exhaustible fossil fuels. Chemical environments always change as consumed nutrients ebb and new foods flow. Organisms that depend on a single, specific combination of nutrients are evolutionary dead ends, and ongoing innovation is needed to survive. Fortunately, many different kinds of molecules canprovide energy and chemical elements like carbon. Some are as familiar as glucose and sucrose, others less so, like the poison pentachlorophenol.
Even a modest number of potential fuel molecules gives rise to an astounding number of fuel combinations on which a metabolism may or may not be viable—an astounding number of metabolic phenotypes. To see how many, imagine a list like that shown in figure 6, comprising a hundred or so potential fuels. Then compute whether the known metabolism of your favorite animal, plant, or bacterium is viable on a specific fuel molecule, such as glucose. If it can synthesize all biomass molecules from the carbon in glucose, write a “1” next to glucose, otherwise write a “0.” Then repeat this computation for the next fuel molecule, the next one after that, and so on, until each fuel has either a “0” or a “1” next to it. Every single “1” in this list means that the metabolism can synthesize the complete suite of biomass molecules from that particular fuel.
The resulting string of a hundred ones and zeroes encapsulates the fuel molecules that a given metabolism can use to sustain life. It is an extremely compact way of summarizing a metabolic phenotype. Metabolic generalists like E. colican survive on dozens of carbon sources, and their phenotype string contains many ones. Metabolic specialists can live on only a few carbon sources, and their phenotypes contain mostly zeroes.
To count how many such phenotypes exist, the different combinations of a hundred-odd fuels on which an organism could be viable, we just need to keep in mind that an organism may (1) or may not (0) be able to live on each fuel—these two and no other possibilities exist. To calculate the total number of possible phenotypes, multiply 2 by itself a hundred times, which yields 2100. This number is greater than 1030, or a 1 with 30 zeroes added, not quite as large as the number of possible metabolisms, but still a very large number, much larger than, say, the number of stars in our galaxy—approximately 1011, or 100 billion.
I was not kidding when I told you that phenotypes are more complex than the modern synthesis would have you believe.
This huge number of phenotypes implies an equally huge number of metabolic innovations. Figure 7 shows one example. The figure’s left side displays the fuel phenotype of a metabolism that can survive on some carbon sources, but not on ethanol, hence the zero next to ethanol. New genes—acquired through gene transfer or otherwise—can change the genotype that brings forth this phenotype. If this change allows the mutant to metabolize ethanol, we replace the “0” next to ethanol with a “1.” Because every conceivable metabolic innovation can be written like this, by replacing a “0” with a “1” in a metabolic phenotype, there are about as many possible metabolic innovations as there are phenotypes. 
Designing a space to house the library of all possible metabolisms would be challenging, in part because its volumes exceed the number of hydrogen atoms in the universe. To allow us to find specific volumes fast, the library would also have to be supremely well organized. It would take me only seconds to find my copy of Darwin’s Originin the small library of my office, but searching for any one book while grazing through the stacks of an average university’s library would be a bad idea. And if somebody had reshelved the Originin the wrong place, it might be lost forever. The problem is much worse in a hyperastronomical library. The universal library might well contain the secret to immortality—or at least the perfect recipe for turkey stuffing—yet the library is so large that we wouldneverfind it unless we knew where to look.
FIGURE 7.A metabolic innovation
An especially simple way to organize the library is to place the most similar texts next to each other. Human librarians do exactly that when they shelve different editions of the same book together. If the metabolic library were organized along these lines, the most similar texts would be immediate neighbors. But there is a problem: To buy or build shelving for this library would be a real pain.
In a human library, every book has two immediate neighbors, one to the left and one to the right, or maximally four, if you want to count the volumes on the shelf above and below as well. How many neighbors would any one text in the metabolic library have? Recall that a string of five-thousand-odd ones and zeroes describes a metabolic genotype. Any neighbor would differ in exactly one of these letters, one chemical reaction that may be either present or absent. (It cannot possibly differ in less than that, and if it differed in more, it would no longer be a neighbor.) There is one neighbor that differs in the first letter of this string, another that differs in the second letter, one that differs in the third letter, and so on, until the very last of these letters. In other words, each metabolic text has not two, not four, but thousands of neighbors, as many as there are biochemical reactions, each of these neighbors differing in a single letter and reaction. Shelves that can hold this sort of inventory aren’t easy to find.
To see how peculiar they would have to be, imagine a much simpler world than ours, the simplest possible chemical world with only one chemical reaction. In this world the metabolic library has only two texts. One of them consists of the letter 1, containing the one and only reaction, the other of the letter 0—it lacks this reaction. Figure 8a shows these texts as the endpoints of a straight line.
A slightly larger universe with two reactions would be big enough for 2 × 2 = 4 possible metabolic texts. One of them has both of these reactions (11), two of them have one reaction but not the other (10, 01), and the fourth metabolism has no reaction (00). Figure 8b shows these metabolisms as the corners of a square.
You may already see where this is going. The next larger reaction universe would have three reactions and 2 × 2 × 2 = 8 possible metabolisms that form the corners of a cube (figure 8c). For a universe with four reactions, we have 2 × 2 × 2 × 2 = 16 possible metabolisms. But which geometric object would correspond to it? As our reaction universe increased from one to two to three reactions, its metabolic texts occupied the endpoints of a line, a square, or a cube, which exist in a one-, two-, and three-dimensional space. Taking it one step further, we need an object in a four-dimensional space.  Spaces with four or more dimensions are hard to visualize, but mathematicians routinely work with them, because we can extend our geometrical laws to them. Just as in a square and a cube, the edges of the object we are looking for have to be equally long, and adjacent edges would have right angles to one another. Such an object is a four-dimensional hypercube. Figure 8d uses a geometric trick to show this hypercube on paper. It has sixteen corners, each one corresponding to one metabolic text—from 0000 to 1111—that is no longer shown in the figure.
FIGURE 8.Hypercubes
This trick no longer works in five dimensions, much less higher ones. But although it is hopeless to imagine higher-dimensional spaces, they follow the same laws as our three-dimensional space: The edges of a hypercube are equally long, adjacent edges are at right angles to one another, and each corner corresponds to a possible metabolism. And such cubes in high-dimensional space turn out to have curious properties well suited to house the metabolic library.
The number of corners in a square is four, in a cube it doubles to eight, and in a four-dimensional hypercube it doubles again to sixteen. With every added dimension, it doubles, and by the time you have reached 5,000 dimensions, this number has become the hyperastronomical 25000, the size of the metabolic library. In other words, we can arrange the library’s metabolic texts on the corners of a hypercube in a 5,000-dimensional space. This is why off-the-shelf shelving would not work. You cannot cram the metabolic library into three puny dimensions. It needs thousands of dimensions to breathe.
A hypercube is also well suited to accommodate the thousands of neighbors near each of the library’s texts. In a simple universe of three reactions, each of the library’s texts—the corner of a cube—has three adjacent corners as its neighbors. Take one of these texts, such as the string 100 in figure 8c, and you reach its neighbors via the edges leading from 100 to the adjacent corners. We get to them either by adding the third reaction to 100, which yields 101, or by adding the second reaction (110), or by eliminating the first reaction (000). All three neighbors—101, 110, and 000—differ from 100 in exactly one character. And what holds for one corner of the cube holds for any other corner: It has three neighbors. Likewise, in a 5,000-dimensional cube, each and every metabolism has as many neighbors as there are dimensions, five thousand in all. You can walk from each metabolic text in five thousand different directions, to find one of its five thousand neighbors in a single step. Each of these neighbors differs from the text in exactly one reaction. Either the neighbor has an additional reaction—in this case one entry of the string changes from 0 to 1—or it has one fewer reaction—one entry changes from 1 to 0.
Evolving organisms are like visitors to the metabolic library. Gene deletions and gene transfer allow them to walk through the library, to step from one metabolic text to another, often an immediate neighbor. All of a text’s neighbors form a neighborhoodin this library, and such neighborhoods are as important for evolution as a city neighborhood is for people’s lives. City neighborhoods are useful because of proximity—everything is reachable within a few easy steps—and neighborhoods in the metabolic library are important for the same reason. Evolution can reach them in a few small steps, minor edits in a genotype. But residents of a city’s neighborhoods can walk in only four cardinal directions—north, south, east, or west—whereas evolution can head in five thousand directions. (Don’t even bother trying to visualize that.) And therefore the neighborhood of a metabolic text may be vastly more interesting, surprising, and diverse. This diversity will be crucial to understanding innovability, as we shall see shortly.
Over time, as alterations in an organism’s genotypic text accumulate, it walks farther and farther, to more and more distant shelves in the library. To gauge how far, we must be able to measure distance. Without that ability, we would be lost, and the library would become a useless maze of stacks—we could not find our way from one shelf to another. Fortunately, the distance Dthat I had used to study the diversity of known metabolic texts does the job. It tells us how far apart in the library two metabolic texts are, and it already told us that some viable texts are very distant indeed. The next insight it provides is the real bombshell, though: We can travel enormous distances through the library and encounter very different stories with the same moral, everywhere.
One day we may know millions of metabolic texts, but even that number would be a tiny fraction of the hyperastronomical metabolic library, less than a few specks of dust in the universe, because the library contains many more metabolisms than the number of organisms that have existed on earth since life began. Even after 3.8 billion years of evolution, life has explored only a tiny fraction of the library.
For all of those billions of years, nature did not need to know what was around the next corner of the library for evolution to proceed. But if we humans want to understand the library, rather than simply live in it, we need to have some way to grasp where new and meaningful texts are. And we need a catalog that classifies texts, like the Dewey Decimal System, or the Library of Congress Classification, grouping books according to subject categories—Art History, Economics, Linguistics—with smaller subcategories such as Romance, Germanic, Slavic languages nested within them. Metabolic phenotypes, the possible meanings of a metabolic text, are the natural subject categories of this library. Their number is larger than those in a library of books, but that’s simply because the library itself is so vast.
A catalog is like a map for this library—it is a genotype-phenotype map that tells us where to find the genotypes with any one phenotype. Without this map, we do not know whether texts with the same subject are scattered or grouped—as they would be in a human library—whether the same shelf houses texts on different subjects, and so on. And because no librarian is in sight, we need to create this map ourselves, roam the library and explore it, like the ancient voyagers who mapped the earth and its continents on their journeys. The library’s huge size will prevent us from mapping every single text, but we can draw the contours of the continents, mountain ranges, rivers, lakes, and deserts, and hope that we can grasp the shape of the whole from their hazy outlines.
But where to start, and how to travel?
Here is a puzzle that will point the way. Take a metabolism with any one phenotype, such as viability on glucose, and ask, What if only one text in our library of more than 101500metabolisms expressed its meaning? As many as five nonillion (5 × 1030) bacteria exist on earth today. This number is vast, a 1 with more than 30 zeroes. But even if each of these bacteria had tried a new enzyme combination every second since life began almost four billion years ago, they would have tried only about 1048such combinations. Their chances of having found the one and only working combination would be vanishingly small, smaller than one in 101450. This number—so small as to be effectively meaningless—means that it would be utterly impossible to find this text through a blind search.
On the one hand, the odds against finding just oneuseful metabolism are vast. On the other hand, life’s diversity shows that evolution had no problem finding it. This means that our premise must be wrong: There has to be more than one metabolism—perhaps even many—that solves the problem of surviving on glucose.
To find them, let’s do what evolution does: journey through the library and edit genomes—through a series of gene transfer or deletion events that add or eliminate at least one gene, enzyme, or reaction. The starting point for such a journey isn’t terribly important. It could be any text in the library, any text that encodes a metabolism viable on glucose or on any other fuel.
So let’s start with a metabolism viable on glucose, and either delete a randomly chosen reaction or add a randomly chosen reaction from the known reaction universe. Nature would make a simple and brutal evaluation of the new text: life or death. But we scientist travelers are privileged, because we can retrace our steps. We compute the meaning of the altered text, and, if it turns out not to be viable on glucose, return to the starting text, and add or delete another random reaction—remember, there are five thousand ways of doing that. But if the neighbor is viable on glucose, the journey continues. We add or delete a second reaction, compute the phenotype, and repeat, more or less ad infinitum
In other words, step from a starting text to its neighbor, to the neighbor’s neighbor, to the neighbor’s neighbor’s neighbor, and see how far you could walk without ever changing its chemical meaning, viability on glucose. Because each step alters a text at random, this walk is a random walkthrough the metabolic library, similar to how a drunkard might stagger home from a night out at the bar, with one difference: Each step in our random walk must encounter a text with the same meaning, the same phenotype.
If there were only one metabolism viable on glucose, this random walk would lead literally nowhere, because the starting text would have no viable neighbors. We would be rooted to the spot. The same would be true if there were a few such texts scattered widely through the library—we could not reach them without destroying viability on the way. And even if they were close together the random walk might not lead far. A few neighbors of the starting text might be viable, buttheirneighbors might not be.
Only if many such texts existed could we roam the library. But in that case we would face a different problem altogether: computing power. To compute one text’s meaning is a breeze, but what if this random walk had thousands of steps, and each could lead in thousands of different directions. This is the sort of problem that could take an off-the-shelf desktop computer years or decades to solve. An entire network of computers—a computing cluster—is required to speed up that computation. And that costs money.
While I was slowly advancing from a Ph.D. student to a postdoctoral researcher, and eventually to a tenured professor at a U.S. research university, funding for the kind of basic research that addresses the problem of evolutionary innovation began drying up. This drought combined with the ailing health of my European family, so when a job offer arrived from Switzerland, I was ready to take a leap across the Atlantic, back to my European roots.
I knew that Switzerland was a world leader in science, enormously productive, and technologically sophisticated. Its world-class system of public education, generous support for academic research, and attractive living conditions are behind this success. I would be sad to leave many dear academic colleagues behind, but the opportunity to join the Swiss scientific community was a privilege both humbling and enticing. Most important, the offer was good enough to finance not only a computing cluster but also a state-of-the-art experimental laboratory. Even better, it would allow me to recruit multiple like-minded researchers from all over the world. It was an offer I could not refuse.
On a crisp fall day in 2006 at the University of Zürich, I was sitting in my newly furnished office, inside an austerely elegant building whose simple geometric contours are drawn in a gleaming blend of glass and metal, when a young Portuguese man walked in. Handsome, soft-spoken, with curious deep brown eyes and a quick smile, he introduced himself as João Rodrigues.
João had studied physics, but he had heard that there were many exciting problems waiting to be solved in biology. He was looking for a new challenge, a difficult problem to crack that would get him a Ph.D. He did not know much biology at the time, but he had assets that many biologists lacked: He was good at mathematics, knew how to program computers, and had already performed large and complicated computations. When I first saw his résumé, I could hardly contain my excitement. João had exactly the skills needed to navigate the vast metabolic library. During his job interview, I shared my passion about learning how nature creates. Fortunately for me, we connected. His eyes lit up. He signed on.
João’s background is typical for researchers in my lab. They hail from a dozen different countries in the Americas, Europe, Asia, and Australia, and from many disciplines, including biology, chemistry, physics, and mathematics. This is not a coincidence, because the problems we tackle require new skill combinations, so much so that I like to compare our work to that of evolution: Studying innovations, like creating them, benefits enormously from novel combinations—not of enzymatic but of intellectual skills.
I soon became impressed with João’s computing wizardry, even though I remained worried that the cluster of more than one hundred computers we had built would still be too slow, that we would never leave the first shelf of the library. But João tricked the machines into working faster, accelerated their computations many times, and eventually launched us far into the library’s vast stacks.
João’s exploration started with a single well-studied metabolism, that of the bacterium E. coliand its viability on glucose—the ability to synthesize all its sixty-odd essential biomass molecules from this single sugar. To find out whether only one metabolism with this ability existed, João first created more than a thousand of E. coli’s neighbors, each of them a metabolism that differs in a single chemical reaction from E. coli. If E. coli’s metabolism is an instruction manual to make all essential biomass molecules, then these neighbors are minor variations on the manual. The first question: Do any of them contain sufficient information to produce all sixty biomass building blocks from glucose?
João computed the answer and quickly found that not one, not two, not three, but hundreds of E. coli’s neighbors are viable on glucose. This discovery contained a simple but vital lesson: The uniqueness of this phenotype is but a deeply flawed prejudice. The neighborhood of any one text contains many other viable texts like it. But nothing had prepared us for what came next, when we began to venture further.
João used E. colias a starting point for deep probes of the metabolic library that led further and further away from the starting text. The objective was to learn how far we could travel—hopping from one viable text to a viable neighbor, to the neighbor’s neighbor, and so on—without losing viability on glucose. How radically could a metabolic text be edited without losing its meaning? When João showed me the answer, my first reaction was disbelief. The furthest viable metabolism he found—the one with the highest D—shared only 20 percent of its reactions with E. coli. We had walked, computationally speaking, almost all the way through the library—80 percent of the distance that separates the furthest volumes—before we were finally unable to find a glucose-viable text by taking a single step.
Worried that this might be a fluke, I asked João for many more random walks, a thousand more, each preserving metabolic meaning, each leading as far as possible, each leaving in a different direction—possible only because the library has so many dimensions. When the answer came back, I was stunned once again. These random walks had led just as far away as the first one. Each of them led to a metabolism that differed in almost 80 percent of its reactions from E. coli. They had found a thousand metabolic texts that shared very little with E. coli, except that all of them could produce everything a cell needs from the carbon and energy stored in glucose. If we had kept on walking, we would have found even more texts, too many even to count, although later we were able to estimate their number in parts of the library. For example, the number of metabolisms with two thousand reactions that are viable on glucose exceeds 10750
The number of texts with the same meaning is itself hyperastronomical. The metabolic library is packed to its rafters with books that tell the same story in different ways.
While we surely had not expected this, our explorations had revealed an even more bizarre feature of the library. The thousand random walks did not end in a few stacks of the library, where texts with similar meanings might huddle in small groups—groups of metabolisms with similar sets of reactions. These texts were just as different from each other as they were from that of E. coli—they encoded metabolisms with very different sets of chemical reactions. The library does not have clearly distinct sections, like rooms that separate all texts on history from those on science. 
FIGURE 9.A genotype network
And even more surprising was what we found when we started new random walks from these texts—as we had done from E. coli—and walked toward other texts without ever changing viability. We always succeeded in reaching them, no matter how far away they were from our starting point. Every single time. This taught us that a connected network of paths linking texts with the same meaning extends throughout the library. I call this network a genotype network. It might look a bit like the network of straight lines in figure 9, where the large rectangle stands for the metabolic library, and the lines connect neighboring texts (circles) with the same meaning. Pictures like this are wobbly visual crutches—two dimensions instead of five thousand, a handful of texts instead of unimaginably many—but they are all we have to visualize places as strange as this.
In an ordinary public library, you might find biographical information about Charles Darwin in one text on a shelf in the history section, and another in biography. In a large research library using the Library of Congress’s classification system, you might find some such texts in section QH (for “Science: Natural History, Biology”), but others in sections DA (“World History, Great Britain”), GN (“Anthropology”), PR (“English Literature”), and even BL (“Religion, Mythology, Rationalism”). But you would find nothing that resembles the organizing principles of the metabolic library. You would not find a network of meaning-preserving paths connecting the Darwin biography in HM (“Sociology, General”) with another in BT (“Doctrinal Theory”). You would not be able to walk from one book to its neighbor, to the neighbor’s neighbor, and so on, almost all the way through the library, without ever being farther than one book away from another that told Darwin’s life story in different words.
In the metabolic library, though, that’s exactly what a browser can do. Its myriad texts with the same meaning could be like stars in our universe, islands separated by vast expanses of dark empty space. But they are not. You can travel between them on a network of well-lit paths.
Thus far, we had cataloged only the volumes of one subject area—viability on glucose—but many other subject areas exist. There are metabolisms that are viable on ethanol, acetate, and dozens of other fuels. And we mapped them, using the same random browsing strategy: different random walks whose editing steps preserved the phenotype—viability on ethanol, for example—and stopped only when we could walk no further. We did that for eighty different fuels, and each time we saw the same pattern. Viable metabolisms can have very different texts—they share as little as 20 percent of their reactions—and form a vast connected genotype network in the metabolic library.
Emboldened by this general pattern, we began to map metabolisms viable on multiple different fuels like ethanol, glucose, and acetate, able to synthesize all biomass molecules from each of them. (The advantage of this ability is obvious: It permits survival when the supply of any one fuel runs out.) Because that metabolic skill would be more difficult to achieve, perhaps only a few metabolisms might have it, all of them shelved in one corner of the library? We were again proven wrong. We studied metabolisms viable on five, ten, twenty, and up to sixty different fuel molecules. Each meaning-preserving random walk starting from one of them led far away. Even some metabolisms viable on sixty different fuels shared fewer than 30 percent of reactions. And the metabolisms with the same phenotype—countless trillions in each subject category—again formed a connected genotype network. 
At this point, I was close to ecstatic. We had stumbled upon fundamental principles that govern the metabolic library’s organization. First, many metabolisms are viable on the same fuel molecules—it matters little which fuels you choose. Organisms can assemble biomass building blocks in many ways, through many different sequences of reactions. Second, many of these metabolisms are very different from each other, sharing only a minority of reactions. Third, the viable metabolisms we found were connected in a gigantic network—a genotype network. This genotype network reached far through the space of metabolism. Each subject area has one such genotype network, and these networks form a densely woven fabric in the metabolic library.
We had accomplished all this with modest means, because our computing power was puny when compared to the number of texts in the metabolic library. We had crudely mapped a world vast beyond imagination. We had crossed an ocean in a bathtub.
Myriad metabolic texts with the same meaning raise the odds of finding any one of them—myriad-fold. Even better, evolution does not just explore the metabolic library like a single casual browser. It crowdsources, employing huge populations of organisms that scour the library for new texts. Every time gene transfer alters the metabolic genotype of an organism, it takes a step through the library. Different readers—billions of them—walk off in different directions to explore the library.
Evolution’s library exploration also differs in another way from how we humans would browse a library. Imagine a hapless organism that steps off the path connecting viable metabolisms by encountering a change—perhaps a gene deletion—that disrupts the metabolic instructions for manufacturing a key molecule. That organism would be dead, courtesy of natural selection. In the metabolic library readers die (and others get born) in an exploration that unfolds over generations
Viewed from afar, the library’s explorers, from bacteria to blue whales, might appear like giant clouds of dust grains—dwarfed by the library itself—drifting this way and that, from one stack to the next, endlessly meandering swirls of living things that try new combinations of chemical reactions over and over and over again. Some die. Others survive, and pass innovative combinations on to subsequent generations. This churning mass of life is evolution in action.
That action would vanish if genotype networks did not exist. If only one text could confer viability on any one fuel, then all members of a population would have to share that text, crowding around it in the library. Whenever a member stepped aside to sneak a peak at another volume, it would die. If only a few similar texts were viable, the population could only explore a tiny section of the library. But because of genotype networks, evolving populations can explore the library far and wide. 
Genotype networks are the first of two keys to innovability. And now for the second: the immense diversity of the neighborhoods where these explorations begin.
Imagine a patch of soil where billions of bacteria can thrive as long as new food arrives occasionally—a leaf blown in from afar, a rotting carcass, or perhaps a ripe apple dropping from a tree. Many molecules in these foods are nutritious, but they would be useless unless one of the microbes had acquired the right combination of enzymes, the right metabolic text for transforming the food into biomass. That very text could be lifesaving once the billions of its soil-mates, all of them hungry, have consumed and exhausted other fuel molecules. This text, a metabolic innovation, could give one microbe a new lease on life.
Even if there were only a hundred fuel molecules, some 1030metabolic phenotypes would exist, and finding this text is to find a specific one of them. There is simply no way you could pack 1030texts into a small neighborhood of the library. Each neighborhood only has enough space for a few thousand texts, whose meanings can encompass a tiny fraction—one in 1026—of all possible phenotypes. It’s as if you borrowed a few volumes at random from the New York Public Library to fill your nightstand and hoped to find The Origin of Speciesamong them—almost impossible. But these odds change if a crowd of readers can browse the library along a genotype network that extends far through the library. Because genotype networks are so large, the population could explore thousands of neighborhoods and increase the odds of finding the new lifesaving phenotype
You may have noticed a hidden premise here: Different neighborhoods must contain different novel phenotypes. Near a volume on photovoltaics, you would find others on medieval French literature, twentieth-century architecture, and Italian cooking, whereas near anothervolume on photovoltaics—in a different part of the library—books on toy trains, World War II, and astrophysics would be shelved. In metabolic terms, you might find metabolisms viable on acetate and ethanol and citrate in one neighborhood, and metabolisms viable on sucrose and fructose in another.
To find out whether this bizarre library organization really exists, we chose pairs of metabolic texts that had the same phenotype (viability on glucose) but that were otherwise very different. The two metabolisms, A and B, were located in different parts of the library—they did not share many reactions—yet both were part of the same genotype network. We then examined the phenotypes of all their five-thousand-odd neighbors, and found that some of them were likewise viable on glucose—they belonged to the same genotype network—while others had lost a critical chemical reaction, which spells death. Yet other neighbors—those we were really interested in—could live on a new combination of fuels, such as ethanol or fructose. For these networks we asked: Do the neighbors of metabolic genotype A—those texts that differ from A in only a single reaction—contain metabolic innovations different from those of the neighbors of metabolic genotype B? If the neighborhood of A contained metabolisms viable on the new fuels ethanol and fructose, would the neighborhood of B contain metabolisms viable on, say, acetate and sucrose?
After analyzing thousands of network pairs, and after studying phenotypes involving eighty different fuel molecules, we had found that the premise was correct. Different neighborhoods contain texts with new meanings, but these meanings differ between neighborhoods. Most metabolic innovations are unique to one neighborhood and do not occur in the other. (Because each new phenotype has its own genotype network, this also means that different genotype networks in the library are interwoven in an unfathomably complex way.)
We then went one step further. With our computers’ help, we wandered once again through a genotype network in the metabolic library, except that now we behaved like inventory clerks with their notepads, listing all the innovations in the immediate neighborhood of our path—all innovations that were within easy reach. We listed all the different new phenotypes in the walker’s neighborhood before the start of the walk, and examined the neighborhood again after the first step. If it contained a new phenotype that was not already on the list, we added it to the list, took one further step, examined the new neighborhood, added any new phenotypes, and so on, for thousands of steps. Because we knew that different neighborhoods contain different innovations, we expected the list to grow over time, as new phenotypes became accessible. But we expected that we would run out of new phenotypes eventually.
Wrong. Long after our notepads were full, we were still encountering innovations.
Worried that this trip had yielded an unusually rich bounty, we went on many more trips, from different starting points in the library, metabolisms viable on different fuel molecules. And we also crowdsourced our shopping, exploring the library not with a single metabolism but with entire populations of evolving metabolisms to tally how many different new phenotypes they found. In every instance, innovations continually piled up, with no sign of slowing down, at a steady clip, unceasingly, no matter how long the exploration continued, a hundred, a thousand, or ten thousand steps, hours, days, weeks, until we ran out of time and needed to do other work. We realized that the innovability of an evolving metabolism would not exhaust itself in our lifetime. 
Innovability in the metabolic library is near limitless, and for that both genotype networks anddiverse neighborhoods are required. They are the two keys to innovability. Genotype networks guarantee that evolving populations can explore the library. Without them the lethal punishment of losing viability would be inevitable. But without diverse neighborhoods in this library, exploring a genotype network would be pointless: The exploration would not turn up many texts with new meanings.
Any librarian who wanted to organize a human library in this way would be locked away. Even if a thousand books told the same story in different ways, no sane librarian would create sections that placed books with all manner of different meanings next to one another. And he would certainly not pack differentneighborhoods around synonymous texts with books in differentsubject categories.
But a closer look reveals that the metabolic library’s catalog is far from a madman’s febrile fantasy. Human libraries are useful only because we havelibrarians who make catalogs suitable for us, where books on photovoltaics stand on one shelf, those on French literature on another, and so on. For a library whose readers have no catalog and can only take random steps, and where missteps are punishable by death, it would be disastrous, because they would be stuck on whatever shelf they started. They would be idiots savants, world experts in one area but completely ignorant in all others, and could never learn anything new—not a smart strategy for surviving in an ever-changing world. For such readers, the metabolic library is perfect, uncannily well set up for innovation. It guarantees eternal learning and innovability.
Even more uncanny: Life’s other libraries are organized the same way.

